const { useState, useEffect } = React;

const BLeagueNews = () => {
const [selectedTeam, setSelectedTeam] = useState(â€˜allâ€™);
const [searchText, setSearchText] = useState(â€™â€™);
const [news, setNews] = useState([]);
const [loading, setLoading] = useState(true);
const [error, setError] = useState(null);
const [lastUpdated, setLastUpdated] = useState(null);

// B1ã‚¯ãƒ©ãƒ–ã¨æ—¥æœ¬ä»£è¡¨ã®ãƒªã‚¹ãƒˆ
const teams = [
{ id: â€˜allâ€™, name: â€˜å…¨ã¦â€™, color: â€˜#1e40afâ€™ },
{ id: â€˜japanâ€™, name: â€˜æ—¥æœ¬ä»£è¡¨â€™, color: â€˜#dc2626â€™ },
{ id: â€˜alvarkâ€™, name: â€˜ã‚¢ãƒ«ãƒãƒ«ã‚¯æ±äº¬â€™, color: â€˜#dc2626â€™ },
{ id: â€˜levangaâ€™, name: â€˜ãƒ¬ãƒãƒ³ã‚¬åŒ—æµ·é“â€™, color: â€˜#7c3aedâ€™ },
{ id: â€˜akitaâ€™, name: â€˜ç§‹ç”°ãƒãƒ¼ã‚¶ãƒ³ãƒãƒ”ãƒãƒƒãƒ„â€™, color: â€˜#059669â€™ },
{ id: â€˜sendaiâ€™, name: â€˜ä»™å°89ERSâ€™, color: â€˜#000000â€™ },
{ id: â€˜gunmaâ€™, name: â€˜ç¾¤é¦¬ã‚¯ãƒ¬ã‚¤ãƒ³ã‚µãƒ³ãƒ€ãƒ¼ã‚ºâ€™, color: â€˜#dc2626â€™ },
{ id: â€˜utsunomiyaâ€™, name: â€˜å®‡éƒ½å®®ãƒ–ãƒ¬ãƒƒã‚¯ã‚¹â€™, color: â€˜#fbbf24â€™ },
{ id: â€˜chibaâ€™, name: â€˜åƒè‘‰ã‚¸ã‚§ãƒƒãƒ„â€™, color: â€˜#dc2626â€™ },
{ id: â€˜kawasakiâ€™, name: â€˜å·å´ãƒ–ãƒ¬ã‚¤ãƒ–ã‚µãƒ³ãƒ€ãƒ¼ã‚¹â€™, color: â€˜#2563ebâ€™ },
{ id: â€˜yokohamaâ€™, name: â€˜æ¨ªæµœãƒ“ãƒ¼ãƒ»ã‚³ãƒ«ã‚»ã‚¢ãƒ¼ã‚ºâ€™, color: â€˜#2563ebâ€™ },
{ id: â€˜niigataâ€™, name: â€˜æ–°æ½Ÿã‚¢ãƒ«ãƒ“ãƒ¬ãƒƒã‚¯ã‚¹BBâ€™, color: â€˜#f97316â€™ },
{ id: â€˜toyamaâ€™, name: â€˜å¯Œå±±ã‚°ãƒ©ã‚¦ã‚¸ãƒ¼ã‚ºâ€™, color: â€˜#000000â€™ },
{ id: â€˜sunrockersâ€™, name: â€˜ã‚µãƒ³ãƒ­ãƒƒã‚«ãƒ¼ã‚ºæ¸‹è°·â€™, color: â€˜#dc2626â€™ },
{ id: â€˜nagoyaâ€™, name: â€˜åå¤å±‹ãƒ€ã‚¤ãƒ¤ãƒ¢ãƒ³ãƒ‰ãƒ‰ãƒ«ãƒ•ã‚£ãƒ³ã‚ºâ€™, color: â€˜#2563ebâ€™ },
{ id: â€˜seahorsesâ€™, name: â€˜ã‚·ãƒ¼ãƒ›ãƒ¼ã‚¹ä¸‰æ²³â€™, color: â€˜#dc2626â€™ },
{ id: â€˜shigaâ€™, name: â€˜æ»‹è³€ãƒ¬ã‚¤ã‚¯ã‚¹â€™, color: â€˜#2563ebâ€™ },
{ id: â€˜kyotoâ€™, name: â€˜äº¬éƒ½ãƒãƒ³ãƒŠãƒªãƒ¼ã‚ºâ€™, color: â€˜#ec4899â€™ },
{ id: â€˜osakaâ€™, name: â€˜å¤§é˜ªã‚¨ãƒ´ã‚§ãƒƒã‚µâ€™, color: â€˜#2563ebâ€™ },
{ id: â€˜shimaneâ€™, name: â€˜å³¶æ ¹ã‚¹ã‚µãƒã‚ªãƒã‚¸ãƒƒã‚¯â€™, color: â€˜#059669â€™ },
{ id: â€˜hiroshimaâ€™, name: â€˜åºƒå³¶ãƒ‰ãƒ©ã‚´ãƒ³ãƒ•ãƒ©ã‚¤ã‚ºâ€™, color: â€˜#dc2626â€™ },
{ id: â€˜ryukyuâ€™, name: â€˜ç‰çƒã‚´ãƒ¼ãƒ«ãƒ‡ãƒ³ã‚­ãƒ³ã‚°ã‚¹â€™, color: â€˜#fbbf24â€™ }
];

// RSSãƒ•ã‚£ãƒ¼ãƒ‰ã‹ã‚‰ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’å–å¾—
useEffect(() => {
fetchNews();
}, []);

const fetchNews = async () => {
setLoading(true);
setError(null);

```
try {
  const response = await fetch('/.netlify/functions/fetch-rss');
  
  if (!response.ok) {
    throw new Error('ãƒ‹ãƒ¥ãƒ¼ã‚¹ã®å–å¾—ã«å¤±æ•—ã—ã¾ã—ãŸ');
  }
  
  const data = await response.json();
  setNews(data.news || []);
  setLastUpdated(data.lastUpdated);
} catch (err) {
  console.error('Error fetching news:', err);
  setError(err.message);
} finally {
  setLoading(false);
}
```

};

// ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°ã•ã‚ŒãŸãƒ‹ãƒ¥ãƒ¼ã‚¹
const filteredNews = news.filter(item => {
const matchesTeam = selectedTeam === â€˜allâ€™ || item.team === selectedTeam;
const matchesSearch = item.title.toLowerCase().includes(searchText.toLowerCase()) ||
item.teamName.toLowerCase().includes(searchText.toLowerCase());
return matchesTeam && matchesSearch;
});

return (
<div className="min-h-screen bg-gradient-to-b from-blue-50 to-white pb-20">
{/* ãƒ˜ãƒƒãƒ€ãƒ¼ */}
<div className="bg-gradient-to-r from-blue-600 to-blue-800 text-white sticky top-0 z-10 shadow-lg">
<div className="px-4 py-4">
<div className="flex items-center justify-between mb-3">
<h1 className="text-2xl font-bold">ğŸ€ Bãƒªãƒ¼ã‚°ãƒ‹ãƒ¥ãƒ¼ã‚¹</h1>
<button
onClick={fetchNews}
disabled={loading}
className="px-3 py-1 bg-white text-blue-600 rounded-lg text-sm font-medium hover:bg-blue-50 transition-colors disabled:opacity-50"
>
{loading ? â€˜æ›´æ–°ä¸­â€¦â€™ : â€˜æ›´æ–°â€™}
</button>
</div>

```
      {/* æ¤œç´¢ãƒãƒ¼ */}
      <div className="relative mb-3">
        <input
          type="text"
          placeholder="ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’æ¤œç´¢..."
          value={searchText}
          onChange={(e) => setSearchText(e.target.value)}
          className="w-full px-4 py-2 pl-10 rounded-lg text-gray-800 focus:outline-none focus:ring-2 focus:ring-blue-300"
        />
        <svg className="absolute left-3 top-2.5 text-gray-400" width="20" height="20" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        </svg>
      </div>

      {/* ãƒãƒ¼ãƒ ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ */}
      <div className="overflow-x-auto -mx-4 px-4">
        <div className="flex gap-2 pb-2" style={{ minWidth: 'max-content' }}>
          {teams.map(team => (
            <button
              key={team.id}
              onClick={() => setSelectedTeam(team.id)}
              className={`px-4 py-2 rounded-full text-sm font-medium whitespace-nowrap transition-all ${
                selectedTeam === team.id
                  ? 'bg-white text-blue-600 shadow-md scale-105'
                  : 'bg-blue-700 text-white hover:bg-blue-600'
              }`}
            >
              {team.name}
            </button>
          ))}
        </div>
      </div>
    </div>
  </div>

  {/* ãƒ‹ãƒ¥ãƒ¼ã‚¹ãƒªã‚¹ãƒˆ */}
  <div className="px-4 py-4">
    {lastUpdated && (
      <div className="mb-4 text-xs text-gray-500">
        æœ€çµ‚æ›´æ–°: {new Date(lastUpdated).toLocaleString('ja-JP')}
      </div>
    )}

    {loading ? (
      <div className="text-center py-12">
        <div className="inline-block animate-spin rounded-full h-12 w-12 border-4 border-blue-500 border-t-transparent"></div>
        <p className="mt-4 text-gray-600">ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>
      </div>
    ) : error ? (
      <div className="text-center py-12">
        <p className="text-red-500 text-lg mb-4">âš ï¸ {error}</p>
        <button
          onClick={fetchNews}
          className="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors"
        >
          å†è©¦è¡Œ
        </button>
      </div>
    ) : (
      <>
        <div className="mb-4">
          <p className="text-sm text-gray-600">
            {filteredNews.length}ä»¶ã®ãƒ‹ãƒ¥ãƒ¼ã‚¹
          </p>
        </div>

        {filteredNews.length === 0 ? (
          <div className="text-center py-12">
            <p className="text-gray-500 text-lg">ãƒ‹ãƒ¥ãƒ¼ã‚¹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸ</p>
          </div>
        ) : (
          <div className="space-y-4">
            {filteredNews.map(item => (
              <div
                key={item.id}
                className="bg-white rounded-lg shadow-md hover:shadow-xl transition-shadow overflow-hidden"
              >
                <div className="p-4">
                  <div className="flex items-start justify-between mb-2">
                    <span className="inline-block px-3 py-1 bg-blue-100 text-blue-800 text-xs font-semibold rounded-full">
                      {item.teamName}
                    </span>
                    <div className="flex items-center text-xs text-gray-500">
                      <svg className="mr-1" width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z" />
                      </svg>
                      {item.date}
                    </div>
                  </div>
                  
                  <h2 className="text-lg font-bold text-gray-800 mb-2 leading-snug">
                    {item.title}
                  </h2>
                  
                  <p className="text-sm text-gray-600 mb-3 line-clamp-2">
                    {item.excerpt}
                  </p>
                  
                  <div className="flex items-center justify-between">
                    <span className="text-xs text-gray-500">{item.source}</span>
                    <a
                      href={item.url}
                      target="_blank"
                      rel="noopener noreferrer"
                      className="flex items-center text-blue-600 text-sm font-medium hover:text-blue-800 transition-colors"
                    >
                      è©³ç´°ã‚’è¦‹ã‚‹
                      <svg className="ml-1" width="14" height="14" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14" />
                      </svg>
                    </a>
                  </div>
                </div>
              </div>
            ))}
          </div>
        )}
      </>
    )}
  </div>

  {/* ãƒ•ãƒƒã‚¿ãƒ¼ */}
  <div className="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 px-4 py-3 shadow-lg">
    <p className="text-xs text-center text-gray-500">
      å„ã‚¯ãƒ©ãƒ–å…¬å¼ã‚µã‚¤ãƒˆã®RSSãƒ•ã‚£ãƒ¼ãƒ‰ã‹ã‚‰å–å¾—ã—ã¦ã„ã¾ã™
    </p>
  </div>
</div>
```

);
};

const root = ReactDOM.createRoot(document.getElementById(â€˜appâ€™));
root.render(<BLeagueNews />);
